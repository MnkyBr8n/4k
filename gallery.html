<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gallery • 4K Digital Art</title>

  <!-- Combined Global CSS (includes gallery + modal base) -->
  <link rel="stylesheet" href="style.css" />

  <!-- Modal Template Styles -->
  <link rel="stylesheet" href="assets/css/templates/dandy.css" />
  <link rel="stylesheet" href="assets/css/templates/classic.css" />
  <link rel="stylesheet" href="assets/css/templates/passport.css" />
  <link rel="stylesheet" href="assets/css/templates/storycard.css" />
  <link rel="stylesheet" href="assets/css/templates/roblox.css" />
  <link rel="stylesheet" href="assets/css/templates/fortnite.css" />
</head>
<body>
  <!-- Navigation -->
  <nav>
    <div class="nav-container">
      <div class="logo">4K</div>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="gallery.html" class="active">Gallery</a></li>
        <li><a href="about.html">About Me</a></li>
        <li><a href="commissions.html">Commissions</a></li>
        <li><a href="draw.html">Draw</a></li>
      </ul>
      <button class="mobile-menu-btn" aria-label="Toggle menu" aria-expanded="false">☰</button>
    </div>
  </nav>

  <!-- Gallery -->
  <section class="gallery-section">
    <div class="container">
      <header class="gallery-header">
        <h1>Art Gallery</h1>
        <p>Explore my original characters, commissions, and fan art. Click a card to open its modal.</p>
      </header>

      <!-- Filters -->
      <div class="gallery-filters" id="filters">
        <button class="filter-btn active" data-filter="all">All Artwork</button>
        <button class="filter-btn" data-filter="ocs">Original Characters</button>
        <button class="filter-btn" data-filter="commissions">Commissions</button>
        <button class="filter-btn" data-filter="progress">In Progress</button>
        <button class="filter-btn" data-filter="fanart">Fan Art</button>
      </div>

      <!-- Dynamic grid -->
      <div class="gallery-grid" id="galleryGrid"></div>
    </div>
  </section>

  <!-- Modal mount (handled by oc-modal-core) -->
  <div id="ocm-root" hidden></div>

  <!-- Modal framework JS -->
  <script type="module" src="assets/js/oc-modal-core.js"></script>
  <script type="module" src="assets/js/templates/dandy.js"></script>
  <script type="module" src="assets/js/templates/classic.js"></script>
  <script type="module" src="assets/js/templates/passport.js"></script>
  <script type="module" src="assets/js/templates/storycard.js"></script>
  <script type="module" src="assets/js/templates/roblox.js"></script>
  <script type="module" src="assets/js/templates/fortnite.js"></script>

  <!-- Global Site JS -->
  <script src="main.js" defer></script>

  <!-- Page script: render from /data/characters.js -->
  <script type="module">
    import { CHARACTERS } from './data/characters.js';

    const grid = document.getElementById('galleryGrid');
    const filtersWrap = document.getElementById('filters');

    // Render all cards from the character data
    function render(list) {
      grid.innerHTML = list.map(c => {
        const category = c.category || 'ocs'; // default to Original Characters
        const tmplAttr = c.template ? ` data-template="${c.template}"` : '';
        const portrait = c.portrait || (c.images?.[0]?.src) || '';
        const learnLink = c.link ? `<a href="${c.link}" class="slide-btn">Learn More</a>` : '';

        return `
          <article class="gallery-item ${category}" data-character="${c.id}"${tmplAttr}>
            <img src="${portrait}" alt="${c.name || c.id}">
            <div class="gallery-item-content">
              <h3>${c.name || ''}</h3>
              <p>${c.aboutQuick || c.role || ''}</p>
              <div class="gallery-item-tags">
                ${Array.isArray(c.tags) ? c.tags.map(t => `<span class="tag">${t}</span>`).join('') : ''}
                ${learnLink}
              </div>
            </div>
          </article>
        `;
      }).join('');
    }

    // Initial render - Convert CHARACTERS object to array
    render(Object.values(CHARACTERS));

    // Filter logic
    filtersWrap.addEventListener('click', (e) => {
      const btn = e.target.closest('.filter-btn');
      if (!btn) return;

      // Set active state
      filtersWrap.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      const filter = btn.dataset.filter;
      const items = grid.querySelectorAll('.gallery-item');

      items.forEach((item, index) => {
        const show = filter === 'all' || item.classList.contains(filter);
        item.style.display = show ? 'block' : 'none';
        if (show) {
          item.style.animationDelay = `${index * 0.05}s`;
          item.classList.add('fade-in');
        } else {
          item.classList.remove('fade-in');
        }
      });
    });
  </script>
</body>
</html>
